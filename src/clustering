import numpy as np
from sklearn.cluster import KMeans, AgglomerativeClustering, DBSCAN
from sklearn.decomposition import PCA
from sklearn.preprocessing import StandardScaler

def apply_kmeans(data, n_clusters=10):
  kmeans = KMeans(n_clusters=n_clusters, random_state=42)
  labels = kmeans.fit_predict(data)
  return labels

def apply_agglomerative(data, n_clusters=10):
  agg = AgglomerativeClustering(n_clusters=n_clusters)
  labels = agg.fit_predict(data)
  return labels

def apply_dbscan(data, eps=0.5, min_samples=5):
  dbscan = DBSCAN(eps=eps, min_samples=min_samples)
  labels = dbscan.fit_predict(data)
  return labels

def apply_pca_kmeans(data, n_clusters=10):
  scaler = StandardScaler()
  data_scaled = scaler.fit_transform(data)
  
  pca = PCA(n_components=20)
  data_pca = pca.fit_transform(data_scaled)
  
  kmeans = KMeans(n_clusters=n_clusters, random_state=42)
  labels = kmeans.fit_predict(data_pca)
  return labels

def get_cluster_centers(data, labels, n_clusters):
  centers = []
  for i in range(n_clusters):
    cluster_points = data[labels == i]
    if len(cluster_points) > 0:
      centers.append(np.mean(cluster_points, axis=0))
  return np.array(centers)
